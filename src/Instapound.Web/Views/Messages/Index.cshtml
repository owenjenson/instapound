@model List<ChatItemModel>

@{
    ViewData["Title"] = $"Chats | Instapound";
}

<h2 class="text-3xl font-semibold mb-6">Chats</h2>

@if (Model.Count > 0)
{
    <ul class="flex flex-col gap-5">
        @foreach (var chat in Model)
        {
            <li>
                <article>
                    <a class="grid grid-rows-[auto_auto] grid-cols-[auto_1fr] gap-x-4 items-center group" asp-controller="Messages" asp-action="Chat" asp-route-id="@chat.User.Id">
                        @{
                            var avatar = chat.User.Avatar is null ?
                                "/images/avatars/default_avatar.png" :
                                $"/images/avatars/{chat.User.Avatar}";
                        }

                        <img loading="lazy" class="cover aspect-square w-9 h-9 rounded-full p-0.5 border-2 border-primary"
                             src="@avatar" />

                        <div>
                            <div class="flex gap-2 items-center">
                                <h3 class="font-semibold text-lg mb-0 group-hover:underline">@chat.User.Name</h3>
                                <small class="text-on-surface-muted">@@@chat.User.UserName</small>
                            </div>

                            <span class="block text-sm text-on-surface-muted">
                                @chat.LatestMessageSentAt
                            </span>
                        </div>

                        <p class="col-start-2 mt-1 text-sm">
                            <span class="font-semibold">@chat.LatestMessageSenderName:</span> @chat.LatestMessage
                        </p>
                    </a>
                </article>
            </li>
        }
    </ul>
}
else
{
    <div class="flex-1 grid place-content-center max-h-96">
        <span class="text-on-surface-muted">No chats</span>
    </div>
}