@model Instapound.Web.Models.UploadFileViewModel

<dialog id="uploadAvatarDialog" class="rounded-xl bg-surface p-4">
    <article class="flex flex-col">
        <h2 class="font-semibold text-2xl mb-6">
            New profile picture
        </h2>

        <img id="uploadAvatarImage" class="self-center mb-6 cover aspect-square w-32 h-32 rounded-full p-1 border-2 border-primary" src="~/images/avatars/default_avatar.png" />

        <form asp-controller="Profile" asp-action="ChangeAvatar" method="post" enctype="multipart/form-data">
            <div class="flex flex-col gap-2 mb-6">
                <input
                    id="uploadAvatarInput"
                       class="rounded-lg border border-outline bg-surface-container text-on-surface-muted file:bg-primary file:text-on-primary file:rounded-lg file:mr-3 p-1"
                    asp-for="File"
                    type="file"
                    accept="image/*" />
                <span asp-validation-for="File" class="text-danger"></span>
            </div>

            <div class="flex gap-2 justify-end">
                <button id="hideUploadAvatarDialogButton" class="btn" type="button">Cancel</button>
                <button class="btn btn-primary" type="Submit">Save</button>
            </div>
        </form>
    </article>
</dialog>

<script>
    window.addEventListener('load', () => {
        document.getElementById('hideUploadAvatarDialogButton').onclick = () => {
            document.getElementById('uploadAvatarDialog').close();
        };

        document.getElementById('uploadAvatarInput').addEventListener('change', (e) => {
            const file = e.currentTarget.files[0];

            uploadAvatarImage.src = file ?
                URL.createObjectURL(file) :
                '/images/avatars/default_avatar.png';
        });
    });
</script>